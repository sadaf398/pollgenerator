<!DOCTYPE html> 
<html style="  height: 100%;
margin: 0;
padding: 0;">
   <head> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
    <!-- <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">  
    </script>   -->
   <script src="https://cdn.jsdelivr.net/npm/jszip@3.7.1/dist/jszip.min.js" defer></script>
   <script src="https://cdn.jsdelivr.net/npm/chart.js" ></script>
   <!-- <script type="module" src="node_modules/exceljs/dist/exceljs.min.js"></script> -->
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.min.js"></script> -->
    <title>poll</title> <link rel="stylesheet" href="style.css"> </head> 
<body style="background-color:#e4decd;  display: flex;
justify-content: center;
align-items: center;
"> 
    
<!-- 
  <div id="part1" class="form-part ">
    <h2>قسمت اول</h2>
<form id="workbook">
  <h2 > نظرسنجی دراپ داون  </h2>
  <label for="name" draggable="true">:نام</label>
  <input type="text" id="name" name="name" required>
  <label for="email">:ایمیل</label>
  <input type="email" id="email" name="email" required>
  <label for="date">:تاریخ</label>
<input type="date" id="date" name="date">
  <label for="rating">:درجه</label>
  <select id="rating" name="rating" required>
    <option value="5">عالی</option>
    <option value="4">خوب</option>
    <option value="3">متوسط</option>
    <option value="2">ضعیف</option>
    <option value="1">خیلی ضعیف</option>
  </select>
  <label for="comment">:نظر شما</label>
  <textarea id="comment" name="comment" rows="4" required></textarea>
  <button onclick="nextPart()">بعدی</button>
</div>


<div id="part2" class="form-part dnon">
  <h2>قسمت دوم</h2>
    <h2>نظرسنجی چندگزینه‌ای</h2>
    <fieldset >
      <legend>کدام یک از موارد زیر را ترجیح می‌دهید؟</legend>
      <label>
        <input type="radio" name="q1" value="option1">
        گزینه ۱
      </label>
      <label>
        <input type="radio" name="q1" value="option2">
        گزینه ۲
      </label>
      <label>
        <input type="radio" name="q1" value="option3">
        گزینه ۳
      </label>
    </fieldset>
    <button onclick="prevPart()">قبلی</button>
    <button onclick="nextPart()">بعدی</button>
  </div>

    

  <div id="part3" class="form-part dnon" >
    <h2>قسمت سوم</h2>
      <h2>نظرسنجی لینکرت</h2>
        <p>Please rate your satisfaction with each Linkert:</p>
        <div class="rating-group">
          <label for="original">Original </label>
          <input type="range" id="original" name="original" min="0" max="10" value="5">
          <output for="original" id="original-output">10</output>
      
          <label for="flavored">Flavored </label>
          <input type="range" id="flavored" name="flavored" min="0" max="10" value="5">
          <output for="flavored" id="flavored-output">10</output>
      
          <label for="vegan">Vegan</label>
          <input type="range" id="vegan" name="vegan" min="0" max="10" value="5">
          <output for="vegan" id="vegan-output">10</output>
      
          <label for="gluten-free">Gluten-free </label>
          <input type="range" id="gluten-free" name="gluten-free" min="0" max="10" value="5">
          <output for="gluten-free" id="gluten-free-output">10</output>
        </div>
        <button onclick="prevPart()">قبلی</button>
        <button onclick="nextPart()">بعدی</button>
      </div>
  
        
      <div id="part4" class="form-part dnon" >
        <h2>قسمت چهارم</h2>
    <h2>نظرسنجی چک باکس</h2>
    <fieldset >
      <legend>:انتخاب کنید</legend>
      <label>
        <input type="checkbox" name="q2" value="option1">
        گزینه ۱
      </label>
      <label>
        <input type="checkbox" name="q2" value="option2">
        گزینه ۲
      </label>
      <label>
        <input type="checkbox" name="q2" value="option3">
        گزینه ۳
      </label>
    </fieldset>
    <button onclick="prevPart()">قبلی</button>
    <button onclick="submitForm()">ارسال</button>
  </div>
  </form> -->



<!-- 
  
  <form id="questionContainer"></form>
  <div class="buttons">
  <button id="previousBtn" onclick="showPreviousQuestion()">قبلی</button>
  <button id="nextBtn" onclick="showNextQuestion()">بعدی</button>
  <button id="submitBtn" class="dnon" type="submit" onclick="submitForm()">ارسال</button>
  </div> -->


 

  <!-- <h1>دریافت اطلاعات صفحات</h1> -->
  <form id="mainForm" style="background-color:rgb(216, 216, 216) ;border-radius: 1em;">
    <div class="firstForm">
    <label for="totalPages">تعداد صفحات فرم:</label>
    <input type="number" id="totalPages" name="totalPages" min="1"><br>
    <button type="button" onclick="addPageTitles()" style="background-color:#82716e; color:#e4decd;  ">ثبت</button>
    </div>

    <div id="pageTitles" class="dnon">
    </div>

    <div id="pages" class="dnon">  
    </div> 
  
    <div id="download-container">
      <button id="download-button" style="background-color:#e4decd; color:#82716e; border-color: #82716e; border-style: solid; border-width: 1.5px;"> دانلود فرم</button>
      <button id="get-button" style="background-color:#e4decd; color:#82716e; border-color: #82716e; border-style: solid; border-width: 1.5px;"onclick="loadChartData()">دریافت اطلاعات و رسم نمودار  📊</button>
      <button id="show-button" class="dnon">show</button>
    </div>
     
 
    <div class="questionsForm dnon">
      <div id="questionsInputContainer">
        <!-- جایگزینی سوالات توسط جاوا اسکریپت -->
      </div>

      <div class="btn1">
    <button type="button" id="addQuestion"style="background-color:#82716e; color:#e4decd;  " onclick="addQuestionInput()">افزودن سوال</button><br>
    <button id="nextButton" style="color: #e4decd;; background-color: #1d1145; " onclick="showNextQuestion()">صفحه بعدی</button>
    <button id="submit" type="submit" class="dnon" style="color: #e4decd;; background-color: #1d1145; " onclick="submitForm()">ارسال فرم</button>
    </div> </div>
    <div id="results"></div>
    <canvas id="chartCanvas" width="400" height="400"></canvas>
    

  </form> 









<!-- 
// $(function() {
//   $('#workbook').submit(function(e) {
//     e.preventDefault();

//     // تبدیل داده‌های فرم به شیت
//     var data = $('#workbook').serializeArray();
//     var jsonData = {};
//     for (var i = 0; i < data.length; i++) {
//       var field = data[i].name;
//       var value = parseFloat(data[i].value) || data[i].value; // تبدیل رشته به عدد
//       jsonData[field] = value;
//     }

//     var worksheet = XLSX.utils.json_to_sheet([jsonData]);

//     // ایجاد کتاب و اضافه کردن شیت به آن
//     var workbook = XLSX.utils.book_new();
//     XLSX.utils.book_append_sheet(workbook, worksheet, 'Survey Results');

//     // تولید فایل اکسل و ارسال به کاربر
//     var wbout = XLSX.write(workbook, {bookType:'xlsx', type:'base64'});

//     var link = document.createElement('a');
//     link.href = 'data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,' + wbout;
//     link.download = 'survey_results.xlsx';
//     link.click();
//  });
// }); -->

 

  <script src="script.js"></script>
 


</body>
</html> 
